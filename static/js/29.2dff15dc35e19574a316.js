webpackJsonp([29],{KFTr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={data:function(){return{ruleForm:{nickname:"",avatar:""},avatarForm:{token:JSON.parse(sessionStorage.getItem("token"))},token:JSON.parse(sessionStorage.getItem("token")),rules:{},id:""}},methods:{UploadUrl:function(){return"api/upload/img"},beforeUploadImg:function(t){var e=t.size/1024/1024<10;return e||this.$message({message:"上传图片大小不能超过 10MB!",type:"warning"}),e},imgSuccess:function(t,e,a){if(0==t.data.code){var r=t.data.info[0];this.ruleForm.avatar=r.res_url}else this.$message({message:"图片上传失败!",type:"error"})},submitForm:function(){var t=this,e=this,a="",r={token:this.token,nickname:this.ruleForm.nickname,avatar:this.ruleForm.avatar};this.$route.query.id?(a=this.baseURL+"/author/update",r.id=this.$route.query.id):a=this.baseURL+"/author/add",this.$axios.post(a,r).then(function(a){var r=a.data.data;0==r.code?(t.$message.success("保存成功！"),setTimeout(function(){e.$router.push("/account")},500)):t.$message.error("保存失败！"+r.msg)})},onCancle:function(){this.$router.push("/account")},getData:function(){var t=this;this.id=this.$route.query.id,this.$axios.post(this.baseURL+"/author/info",{token:this.token,id:this.id}).then(function(e){var a=e.data.data;0==a.code?(t.ruleForm.nickname=a.info.nickname,t.ruleForm.avatar=a.info.avatar):t.ruleForm={nickname:"",avatar:""}})}},watch:{$route:function(t,e){this.$route.query.id&&this.getData()}},mounted:function(){this.$route.query.id&&this.getData()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/account"}}},[a("i",{staticClass:"el-icon-tickets"}),t._v("账户管理\n      ")]),t._v(" "),a("el-breadcrumb-item",[t._v("添加发布者")])],1)],1),t._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"addaccount-container"},[a("div",{staticClass:"addaccount-title"},[t._v("添加发布者")]),t._v(" "),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色昵称",prop:"email"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入角色昵称"},model:{value:t.ruleForm.nickname,callback:function(e){t.$set(t.ruleForm,"nickname",e)},expression:"ruleForm.nickname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"上传头像",prop:"img"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.UploadUrl(),data:t.avatarForm,"on-success":t.imgSuccess,"before-upload":t.beforeUploadImg,"show-file-list":!1}},[t.ruleForm.avatar?a("img",{staticClass:"avatar",staticStyle:{width:"80px",height:"80px"},attrs:{src:t.ruleForm.avatar}}):a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("点击上传头像")])])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("添加")]),t._v(" "),a("el-button",{on:{click:t.onCancle}},[t._v("取消")])],1)],1)],1)])])},staticRenderFns:[]};var i=a("VU/8")(r,s,!1,function(t){a("rSzm")},null,null);e.default=i.exports},rSzm:function(t,e){}});