webpackJsonp([24],{Lml3:function(t,e){},xl0m:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),a=i.n(s),o={data:function(){return{form:{title:"",content:[{img:"",isFront:"0",desc:""},{img:"",isFront:"1",desc:""}]},dataForm:{token:JSON.parse(sessionStorage.getItem("token"))},token:JSON.parse(sessionStorage.getItem("token")),sysKey:""}},methods:{getKey:function(t){this.sysKey=t},UploadUrl:function(){return"api/upload/img"},beforeUploadImg:function(t){var e=t.size/1024/1024<10;return e||this.$message({message:"上传图片大小不能超过 10MB!",type:"warning"}),e},imgSuccess:function(t,e,i){if(0==t.data.code){var s=t.data.info[0];this.form.content[this.sysKey].img=s.res_url}else this.$message({message:"图片上传失败!",type:"error"})},onSubmit:function(){var t=this,e=this,i="",s={token:this.token,title:this.form.title,content:a()(this.form.content)};this.$route.query.id?(i="api/occupy/update",s.id=this.$route.query.id):i="api/occupy/add",this.$axios.post(i,s).then(function(i){var s=i.data.data;0==s.code?(t.$message.success("保存成功！"),setTimeout(function(){e.$router.push("/divinationday")},500)):t.$message.error("保存失败！"+s.msg)})},getData:function(){var t=this;this.id=this.$route.query.id,this.$axios.post("api/occupy/info",{token:this.token,id:this.id}).then(function(e){var i=e.data.data;0==i.code?(t.form.title=i.info.title,t.form.content=JSON.parse(i.info.content)):t.form={title:"",content:[{img:"",isFront:"0",desc:""},{img:"",isFront:"1",desc:""}]}})},onCancle:function(){this.$router.push("/divinationday")}},created:function(){this.$route.query.id&&this.getData()},watch:{$route:function(t,e){this.$route.query.id&&this.getData()}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/divinationday"}}},[i("i",{staticClass:"el-icon-date"}),t._v("每日一占\n      ")]),t._v(" "),i("el-breadcrumb-item",[t._v("新建占卜解读")])],1)],1),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"form-box"},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"名称",prop:"title"}},[i("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"图片及解读",prop:"title"}},[i("div",{staticClass:"analysisTaro"},t._l(t.form.content,function(e,s){return i("div",{key:s,staticClass:"analysisTaroTaroContainer"},[i("div",{staticClass:"analysisTaroLeft",on:{click:function(e){t.getKey(s)}}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.UploadUrl(),data:t.dataForm,"show-file-list":!1,"on-success":t.imgSuccess,"before-upload":t.beforeUploadImg}},[e.img?i("img",{staticClass:"avatar",attrs:{src:e.img}}):i("i",{staticClass:"el-icon-upload"}),t._v(" "),"0"==e.isFront?i("div",{staticClass:"el-upload__text"},[t._v("点击上传正位图片")]):t._e(),t._v(" "),"1"==e.isFront?i("div",{staticClass:"el-upload__text"},[t._v("点击上传逆位图片")]):t._e()])],1),t._v(" "),i("div",{staticClass:"analysisTaroRight"},[i("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入解读"},model:{value:e.desc,callback:function(i){t.$set(e,"desc",i)},expression:"item.desc"}})],1)])}))]),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),i("el-button",{on:{click:t.onCancle}},[t._v("取消")])],1)],1)],1)])])},staticRenderFns:[]};var r=i("VU/8")(o,n,!1,function(t){i("Lml3")},null,null);e.default=r.exports}});