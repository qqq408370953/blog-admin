webpackJsonp([19],{"6yL6":function(t,e){},xl0m:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),o={data:function(){return{form:{title:"",content:[{img:"",isFront:"0",desc:""},{img:"",isFront:"1",desc:""}]},dataForm:{token:JSON.parse(sessionStorage.getItem("token"))},token:JSON.parse(sessionStorage.getItem("token")),sysKey:""}},methods:{getKey:function(t){this.sysKey=t},UploadUrl:function(){return this.baseURL+"/upload/img"},beforeUploadImg:function(t){var e=t.size/1024/1024<10;return e||this.$message({message:"上传图片大小不能超过 10MB!",type:"warning"}),e},imgSuccess:function(t,e,s){if(0==t.data.code){var i=t.data.info[0];this.form.content[this.sysKey].img=i.res_url}else this.$message({message:"图片上传失败!",type:"error"})},onSubmit:function(){var t=this,e=this,s="",i={token:this.token,title:this.form.title,content:a()(this.form.content)};this.$route.query.id?(s=this.baseURL+"/occupy/update",i.id=this.$route.query.id):s=this.baseURL+"/occupy/add",this.$axios.post(s,i).then(function(s){var i=s.data.data;0==i.code?(t.$message.success("保存成功！"),setTimeout(function(){e.$router.push("/divinationday")},500)):t.$message.error("保存失败！"+i.msg)})},getData:function(){var t=this;this.id=this.$route.query.id,this.$axios.post(this.baseURL+"/occupy/info",{token:this.token,id:this.id}).then(function(e){var s=e.data.data;0==s.code?(t.form.title=s.info.title,t.form.content=JSON.parse(s.info.content)):t.form={title:"",content:[{img:"",isFront:"0",desc:""},{img:"",isFront:"1",desc:""}]}})},onCancle:function(){this.$router.push("/divinationday")}},created:function(){this.$route.query.id&&this.getData()},watch:{$route:function(t,e){this.$route.query.id&&this.getData()}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"crumbs"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/divinationday"}}},[s("i",{staticClass:"el-icon-date"}),t._v("每日一占\n      ")]),t._v(" "),s("el-breadcrumb-item",[t._v("新建占卜解读")])],1)],1),t._v(" "),s("div",{staticClass:"container"},[s("div",{staticClass:"form-box"},[s("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"名称",prop:"title"}},[s("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"图片及解读",prop:"title"}},[s("div",{staticClass:"analysisTaro"},t._l(t.form.content,function(e,i){return s("div",{key:i,staticClass:"analysisTaroTaroContainer"},[s("div",{staticClass:"analysisTaroLeft",on:{click:function(e){t.getKey(i)}}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.UploadUrl(),data:t.dataForm,"show-file-list":!1,"on-success":t.imgSuccess,"before-upload":t.beforeUploadImg}},[e.img?s("img",{staticClass:"avatar",attrs:{src:e.img}}):s("i",{staticClass:"el-icon-upload"}),t._v(" "),"0"==e.isFront?s("div",{staticClass:"el-upload__text"},[t._v("点击上传正位图片")]):t._e(),t._v(" "),"1"==e.isFront?s("div",{staticClass:"el-upload__text"},[t._v("点击上传逆位图片")]):t._e()])],1),t._v(" "),s("div",{staticClass:"analysisTaroRight"},[s("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入解读"},model:{value:e.desc,callback:function(s){t.$set(e,"desc",s)},expression:"item.desc"}})],1)])}))]),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),s("el-button",{on:{click:t.onCancle}},[t._v("取消")])],1)],1)],1)])])},staticRenderFns:[]};var r=s("VU/8")(o,n,!1,function(t){s("6yL6")},null,null);e.default=r.exports}});