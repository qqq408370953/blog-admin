webpackJsonp([11],{"55rq":function(t,e){},jrEo:function(t,e,a){"use strict";(function(t){var i=a("bOdI"),s=a.n(i);e.a={data:function(){var t;return t={passForm:{password:""},message:"first",showHeader:!1,activeName:"first",accountManagement:[],accountManagement1:[],token:JSON.parse(sessionStorage.getItem("token")),cur_page:1,page:"",limit:"",total:"",pageInfo:{first:0,before:0,current:0,last:0,next:0,total_pages:0},pageInfo1:{first:0,before:0,current:0,last:0,next:0,total_pages:0},editVisible:!1,user:"",password:"",tipFlag:!1,delItem:{},list:[]},s()(t,"pageInfo",{}),s()(t,"permissions",[]),s()(t,"authList",[]),s()(t,"selectObj",{}),s()(t,"selectId",""),s()(t,"isEdit",!0),t},methods:{handleCurrentChange:function(t){this.cur_page=t,this.getData({})},changeTime:function(t){var e=new Date(Number(t+"000")),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate();return a+"-"+(i=i>9?i:"0"+i)+"-"+(s=s>9?s:"0"+s)},search:function(){},handleSelectionChange:function(){},handleRead:function(t){var e=this.unread.splice(t,1);this.read=e.concat(this.read)},handleDel:function(t){var e=this.read.splice(t,1);this.recycle=e.concat(this.recycle)},handleRestore:function(t){var e=this.recycle.splice(t,1);this.read=e.concat(this.read)},handleClick:function(t,e){},handleEdit:function(t,e){this.$router.push({path:"addaccount",query:{id:e.user_id}})},handleDelete:function(t){var e=this,a=this,i={token:this.token,user_id:t.user_id};this.$axios.post("api/user/disable",i).then(function(t){var i=t.data.data;0==i.code?(e.$message.success("删除成功！"),a.getData({})):e.$message.error("删除失败！"+i.msg)})},handleEdit1:function(t){this.$router.push({path:"addpublishers",query:{id:t.id}})},okSubmit:function(){var t=this,e=this,a={token:this.token,user:this.user,password:this.passForm.password};this.$axios.post("api/user/updPwd",a).then(function(a){var i=a.data.data;0==i.code?(t.$message.success("密码修改成功！"),e.editVisible=!1):(t.$message.error("密码修改失败！"+i.msg),e.editVisible=!0)})},getData:function(t){var e=this;t.token=this.token,"first"==this.activeName?this.$axios.post("api/user/list",{page:this.cur_page,limit:this.limit,token:this.token}).then(function(t){var a=t.data.data;if(0==a.code){e.accountManagement=a.info.items;var i={first:a.info.first,before:a.info.before,current:a.info.current,last:a.info.last,next:a.info.next,total_pages:a.info.total_pages,total_items:a.info.total_items,limit:a.info.limit};e.pageInfo=i}else e.accountManagement=[]}):"second"==this.activeName&&this.$axios.post("api/author/list",{page:this.cur_page,limit:this.limit,token:this.token}).then(function(t){var a=t.data.data;if(0==a.code){e.accountManagement1=a.info.items;var i={first:a.info.first,before:a.info.before,current:a.info.current,last:a.info.last,next:a.info.next,total_pages:a.info.total_pages,total_items:a.info.total_items,limit:a.info.limit};e.pageInfo1=i}else e.accountManagement1=[]})},changeRole:function(e,a){this.authList=this.list[e].auth_ids.split(","),this.selectObj=this.list[e],this.selectId=this.list[e].role_id,t(".np-table-list-li").removeClass("hover"),t(a.target).addClass("hover")},delRole:function(t){mv.delItem=t,mv.tipFlag=!0},cancle:function(){mv.delItem={},mv.tipFlag=!1},ok:function(){var t=this,e={token:this.token,role_ids:this.delItem.role_id};this.$axios.post("api/role/del",e).then(function(e){0==e.data.data.code&&(t.tipFlag=!1,t.getRoleList(),t.delItem={})})},authTree:function(){var t=this,e={token:this.token};this.$axios.post("api/auth/tree",e).then(function(e){var a=e.data.data;0==a.code&&(t.permissions=a.info,t.reqfn())})},reqfn:function(){var t=this,e={token:this.token};this.$axios.post("api/role/list",e).then(function(e){var a=e.data.data;0==a.code&&(t.list=a.info.items,t.authList=a.info.items[0].auth_ids.split(","),t.selectObj=t.list[0],t.selectId=t.list[0].role_id)})},topFilter:function(t){var e=["首页"];return!(Array.prototype.includes?e.includes(t):e.indexOf(t)>=0)},secFilter:function(t){var e=["菜单管理"];return!(Array.prototype.includes?e.includes(t):e.indexOf(t)>=0)}},created:function(){sessionStorage.getItem("activeName")&&(this.activeName=sessionStorage.getItem("activeName")),this.getData({})},mounted:function(){this.user=JSON.parse(sessionStorage.getItem("user")).userInfo.username,this.authTree()},watch:{$route:function(t,e){sessionStorage.getItem("activeName")&&(this.activeName=sessionStorage.getItem("activeName")),this.getData({})},activeName:function(t){sessionStorage.setItem("activeName",t),this.getData({})}},computed:{unreadNum:function(){return this.unread.length}}}}).call(e,a("7t+N"))},kFYC:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("jrEo"),s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-tickets"}),t._v("账户设置\n      ")]),t._v(" "),a("el-breadcrumb-item",[t._v("账户管理")])],1)],1),t._v(" "),a("div",{staticClass:"container"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"账户管理",name:"first"}},[a("div",{staticClass:"handle-box-account"},[a("router-link",{staticStyle:{color:"#fff"},attrs:{to:{path:"/addaccount"}}},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete",size:"small"}},[t._v("添加账户")])],1),t._v(" "),a("div",{staticClass:"margin-15"}),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.accountManagement,border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"username",label:"账户或邮箱"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(t.changeTime(e.row.create_time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"realname",label:"姓名",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"role",label:"角色",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{layout:"prev, pager, next,jumper,total",total:t.pageInfo.total_items},on:{"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"我的账户",name:"second"}},[a("div",{staticClass:"account-title"},[t._v("账户信息")]),t._v(" "),a("div",{staticClass:"account-container"},[a("div",{staticClass:"container-row"},[a("span",[t._v("账户或邮箱")]),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.user))])]),t._v(" "),a("div",{staticClass:"container-row"},[a("span",[t._v("账户密码")]),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v("******")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"small"},on:{click:function(e){t.editVisible=!0}}},[t._v("修改")])],1)]),t._v(" "),a("div",{staticClass:"account-title"},[t._v("发布者角色")]),t._v(" "),a("div",{staticClass:"margin-15"}),t._v(" "),a("div",{staticClass:"handle-box-account1"},[a("router-link",{staticStyle:{color:"#fff"},attrs:{to:{path:"/addpublishers"}}},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete",size:"small"}},[t._v("添加发布者")])],1),t._v(" "),a("div",{staticClass:"margin-15"}),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.accountManagement1,border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"nickname",label:"昵称",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"avatar",label:"头像",width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"80px",height:"80px","border-radius":"40px"},attrs:{src:t.row.avatar,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"update_time",label:"创建时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleEdit1(e.row)}}},[t._v("编辑")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{layout:"prev, pager, next,jumper,total",total:t.pageInfo1.total_items},on:{"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"权限管理",name:"third"}},[a("div",{staticClass:"np-manage-nav-container"},[a("div",{staticClass:"np-manage-body-title"},[t._v("\n            权限管理\n            ")]),t._v(" "),a("div",{staticClass:"np-manage-body-nav"})]),t._v(" "),a("div",{staticClass:"np-manage-body-container"},[a("div",{staticClass:"np-manage-body-box"},[a("div",{staticClass:"np-table-box"},[a("div",{staticClass:"np-table-list"},[0==t.list.length?a("div",{staticClass:"np-no-data"},[t._v("暂无角色")]):t._e(),t._v(" "),t.list.length>0?a("div",{staticClass:"np-table-list-nav"},t._l(t.list,function(e,i){return a("div",{key:i,staticClass:"np-table-list-li",class:{hover:0==i},on:{click:function(e){t.changeRole(i,e)}}},[t._v(t._s(e.title))])})):t._e(),t._v(" "),t.list.length>0?a("div",{staticClass:"np-table-list-body"},[a("div",{staticClass:"np-table-list-title"},[t._v("\n                    权限\n                    "),t._v(" "),a("router-link",{staticClass:"pull-right-edit font-14",staticStyle:{"margin-right":"20px"},attrs:{to:{path:"/editauthority",query:{id:t.selectId}}}},[t._v("编辑")])],1),t._v(" "),a("div",t._l(t.permissions,function(e){return a("div",{key:e.auth_id},t._l(e.children,function(e){return a("div",{key:e.auth_id},[a("div",[a("div",{staticClass:"np-form-body border-gray"},[a("div",{staticClass:"np-row-title"},[t._v(t._s(e.title)+"相关")]),t._v(" "),a("div",{staticClass:"np-input-box-row"},[a("div",{staticClass:"np-input-label-body"},t._l(e.children,function(e){return a("label",{key:e.auth_id,staticClass:"np-label-checkbox col-2",attrs:{for:"v"+e.auth_id}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.authList,expression:"authList"}],attrs:{type:"checkbox",disabled:"",id:"v"+e.auth_id},domProps:{value:e.auth_id,checked:Array.isArray(t.authList)?t._i(t.authList,e.auth_id)>-1:t.authList},on:{change:function(a){var i=t.authList,s=a.target,n=!!s.checked;if(Array.isArray(i)){var l=e.auth_id,o=t._i(i,l);s.checked?o<0&&(t.authList=i.concat([l])):o>-1&&(t.authList=i.slice(0,o).concat(i.slice(o+1)))}else t.authList=n}}}),t._v("\n                                  "+t._s(e.title)+"\n                                ")])}))])])])])}))}))]):t._e()])])])])])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:t.editVisible,width:"30%"},on:{"update:visible":function(e){t.editVisible=e}}},[a("el-form",{ref:"passForm",attrs:{model:t.passForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"新密码"}},[a("el-input",{model:{value:t.passForm.password,callback:function(e){t.$set(t.passForm,"password",e)},expression:"passForm.password"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.okSubmit()}}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var n=function(t){a("55rq")},l=a("VU/8")(i.a,s,!1,n,null,null);e.default=l.exports}});