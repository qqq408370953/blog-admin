webpackJsonp([10],{FJAn:function(t,i){},SIEA:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("YWPb"),a={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("div",{staticClass:"crumbs"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/account"}}},[e("i",{staticClass:"el-icon-date"}),t._v("权限管理\n      ")]),t._v(" "),e("el-breadcrumb-item",[t._v("修改角色权限")])],1)],1),t._v(" "),e("div",{staticClass:"container"},[e("div",{staticClass:"np-form-title"},[t._v("修改角色名称")]),t._v(" "),e("div",{staticClass:"np-form-body"},[e("div",{staticClass:"np-form-group margin-bt-20 np-must"},[e("label",{attrs:{for:"role"}},[t._v("角色名称")]),t._v(" "),e("div",{staticClass:"np-input-box"},[e("div",{staticClass:"np-input-box-body"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text"},domProps:{value:t.title},on:{input:function(i){i.target.composing||(t.title=i.target.value)}}})]),t._v(" "),e("div",{staticClass:"np-input-box-tip"},[t._v(t._s(t.titleTip))])])])]),t._v(" "),e("div",{staticClass:"np-form-title"},[t._v("权限设置")]),t._v(" "),e("div",{staticClass:"np-form-body"},t._l(t.permissions,function(i){return e("div",{key:i.auth_id},t._l(i.children,function(i){return e("div",{key:i.auth_id},[e("div",{staticClass:"np-form-body border-gray"},[e("div",{staticClass:"np-row-title"},[t._v("\n              "+t._s(i.title)+"相关  \n              "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.all,expression:"all"}],attrs:{type:"checkbox"},domProps:{value:i,checked:Array.isArray(t.all)?t._i(t.all,i)>-1:t.all},on:{click:function(e){t.allClick(i)},change:function(e){var s=t.all,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=i,l=t._i(s,o);a.checked?l<0&&(t.all=s.concat([o])):l>-1&&(t.all=s.slice(0,l).concat(s.slice(l+1)))}else t.all=n}}})]),t._v(" "),e("div",{staticClass:"np-input-box-row"},[e("div",{staticClass:"np-input-label-body"},t._l(i.children,function(i){return e("label",{key:i.auth_id,staticClass:"np-label-checkbox col-2",attrs:{for:"v"+i.auth_id}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.authList,expression:"authList"}],attrs:{type:"checkbox",id:"v"+i.auth_id},domProps:{value:i.auth_id,checked:Array.isArray(t.authList)?t._i(t.authList,i.auth_id)>-1:t.authList},on:{change:function(e){var s=t.authList,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=i.auth_id,l=t._i(s,o);a.checked?l<0&&(t.authList=s.concat([o])):l>-1&&(t.authList=s.slice(0,l).concat(s.slice(l+1)))}else t.authList=n}}}),t._v("\n                  "+t._s(i.title)+"\n                ")])}))])])])}))})),t._v(" "),e("div",{staticClass:"np-form-btn-box text-center padding-left-100"},[e("el-button",{attrs:{type:"primary"},on:{click:function(i){t.okSubmit()}}},[t._v("确 定")]),t._v(" "),e("el-button",{on:{click:t.onCancle}},[t._v("取 消")])],1)])])},staticRenderFns:[]};var n=function(t){e("FJAn")},o=e("VU/8")(s.a,a,!1,n,null,null);i.default=o.exports},YWPb:function(t,i,e){"use strict";(function(t){i.a={data:function(){return{pageTitle:"创建角色",title:"",authList:[],permissions:[],tipFlag:!1,tipText:"",role_id:"",titleTip:"",authListTip:"",all:[],token:JSON.parse(sessionStorage.getItem("token"))}},methods:{okSubmit:function(){var t=this,i=this,e={token:this.token,title:this.title,auth_ids:this.authList.join(","),role_id:this.$route.query.id};this.$axios.post("api/role/update",e).then(function(e){var s=e.data.data;console.log(s),0==s.code?(t.$message.success("角色权限编辑成功！"),i.$router.push("/account")):t.$message.error("角色权限编辑失败！"+s.msg)})},onCancle:function(){this.$router.push("/account")},allClick:function(t){console.log(t);var i,e=[];if(this.all.indexOf(t)<0){if(t.children.length>0){e=t.children;for(var s=0;s<e.length;s++)(i=this.authList.indexOf(e[s].auth_id))<0&&this.authList.push(e[s].auth_id)}}else if(t.children.length>0){e=t.children;for(s=0;s<e.length;s++)(i=this.authList.indexOf(e[s].auth_id))>=0&&this.authList.splice(i,1)}},changeRole:function(i,e){this.authList=this.list[i].auth_ids.split(","),this.selectObj=this.list[i],this.selectId=this.list[i].role_id,t(".np-table-list-li").removeClass("hover"),t(e.target).addClass("hover")},authTree:function(){var t=this,i={token:this.token};this.$axios.post("api/auth/tree",i).then(function(i){var e=i.data.data;0==e.code&&(t.permissions=e.info,console.log(t.permissions),t.getRoleInfo())})},getRoleInfo:function(){var t=this,i={token:this.token,role_id:this.$route.query.id};this.$axios.post("api/role/info",i).then(function(i){var e=i.data.data;console.log(e),0==e.code&&(t.authList=e.info.roleInfo.auth_ids.split(","),t.title=e.info.roleInfo.title)})}},mounted:function(){this.user=JSON.parse(sessionStorage.getItem("user")).userInfo.username,this.authTree()}}}).call(i,e("7t+N"))}});